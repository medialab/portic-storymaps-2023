<html>

<head>
    <script src='./vendors/maplibre-gl.js'></script>
<link href='./vendors/maplibre-gl.css' rel='stylesheet' />
</head>
<body>
<div id='map' style='width: 100%; height: 100%;'></div>
<script>
var map = new maplibregl.Map({
    container: 'map',
        style: "https://geoserveis.icgc.cat/contextmaps/positron.json",
//         {
// 'version': 8,
// 'sources': {
// 'raster-tiles': {
// 'type': 'raster',
// 'tiles': [
// 'https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg'
// ],
// 'tileSize': 256,
// 'attribution':
// 'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'
// }
// },
// 'layers': [
// {
// 'id': 'simple-tiles',
// 'type': 'raster',
// 'source': 'raster-tiles',
// 'minzoom': 0,
// 'maxzoom': 22
// }
//]
//},
        center: [0,0],
        zoom: 1// starting zoom
});
map.on('load', function () {
        map.addSource('partner_grouping', {
            'type': 'geojson',
            'data': "./marseille_partner_groupings_import_export_geoloc.json"
        });

        map.addLayer({
            'id': 'circles',
            'type': 'circle',
            'source': 'partner_grouping',
            'paint': {
                'circle-color': ['interpolate-lab',  ['linear'], ['/', ['-', ['coalesce', ['get', 'exports'],0],['coalesce', ['get', 'imports'],0]], ['+', ['coalesce', ['get', 'imports'], 0], ['coalesce', ['get', 'exports'],0] ] ], -1, [
                  "to-color",
                  "#d4322c"
                ],
                0,
                [
                  "to-color",
                  "#c1b65b"
                ],
                1,
                [
                  "to-color",
                  "#22964f"
                ]],
                'circle-opacity': 0.8,
                'circle-radius': ['interpolate',  ['linear'], ['sqrt', ['+', ['coalesce', ['get', 'imports'], 0], ['coalesce', ['get', 'exports'],0] ]],  10, 5,  100, 8,  1000, 10,  1500, 12,  3000, 20,  10000, 50]
            }
        });
        map.addLayer({
id: 'text',
type: 'symbol',
source: 'partner_grouping',
layout: {
'text-field': '{name}',
'text-font': ['Cardo-Bold'],
'text-size': 12
}
});

      
    });
</script>
</body>
</htlm>